require("tikzDevice")

## FIGURE 3 ##
# create table with all relevant values
logtable <- cbind(table[,1:5],log10(table[,5]))
colnames(logtable)[6] <- "log10BF_12"
logtablefig_phi0.2 <- matrix(NA,ncol=6,nrow=4)
colnames(logtablefig_phi0.2) <- c("n_orig","n_repl","dD0.0","dD0.2","dD0.5","dD0.8")
logtablefig_phi0.2[,1:2] <- c(40,40,100,100,40,100,40,100)
logtablefig_phi0.2[1,3:6] <- c(logtable[17:20,6])
logtablefig_phi0.2[2,3:6] <- c(logtable[21:24,6])
logtablefig_phi0.2[3,3:6] <- c(logtable[29:32,6])
logtablefig_phi0.2[4,3:6] <- c(logtable[33:36,6])


logtablefig_phi0.35 <- matrix(NA,ncol=6,nrow=4)
colnames(logtablefig_phi0.35) <- c("n_orig","n_repl","dD0.0","dD0.2","dD0.5","dD0.8")
logtablefig_phi0.35[,1:2] <- c(40,40,100,100,40,100,40,100)
logtablefig_phi0.35[1,3:6] <- c(logtable[53:56,6])
logtablefig_phi0.35[2,3:6] <- c(logtable[57:60,6])
logtablefig_phi0.35[3,3:6] <- c(logtable[65:68,6])
logtablefig_phi0.35[4,3:6] <- c(logtable[69:72,6])

logtablefig_phi0.5 <- matrix(NA,ncol=6,nrow=4)
colnames(logtablefig_phi0.5) <- c("n_orig","n_repl","dD0.0","dD0.2","dD0.5","dD0.8")
logtablefig_phi0.5[,1:2] <- c(40,40,100,100,40,100,40,100)
logtablefig_phi0.5[1,3:6] <- c(logtable[89:92,6])
logtablefig_phi0.5[2,3:6] <- c(logtable[93:96,6])
logtablefig_phi0.5[3,3:6] <- c(logtable[101:104,6])
logtablefig_phi0.5[4,3:6] <- c(logtable[105:108,6])

# create .tex file for Figure 3a
tikz('D:/Dropbox/April2016/April/Data archive April/Figures/BFplot_phi02.tex',width=430/72.27,height=250/72.27)
par(mar=c(6.1, 6.1, 2.1, 2.1),mgp=c(5, 1, 0))
plot(c(0.0,0.2,0.5,0.8),logtablefig_phi0.2[1,3:6],type="b",pch=4,lty=1,lwd=2,bty="l",ylab="BF12",xlab="deltaDelta",xaxt="n",ylim=c(log10(0.01),log10(70)),yaxt="n")
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.2[2,3:6],type="b",pch=4,lty=2,lwd=2)
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.2[3,3:6],type="b",pch=1,lty=1,lwd=2)
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.2[4,3:6],type="b",pch=1,lty=2,lwd=2)
legend(x=0.5,y=log10(70),legend=c("nrepl=40","nrepl=100"),lty=c(1,2),box.lty=0)
legend(x=0.7,y=log10(70),legend=c("norig=40","norig=100"),pch=c(4,1),box.lty=0)
axis(1, at=seq(0,0.8,0.1))
axis(2, at=c(log10(0.01),log10(1/3),log10(1),log10(3),log10(10)),labels=c("log0.01","log1/3","log1","log3","log10"),las=1)
abline(h=log10(1))
abline(h=log10(1/3),lty=2)
abline(h=log10(3),lty=2)
dev.off()

# create .tex file for Figure 3b
tikz('D:/Dropbox/April2016/April/Data archive April/Figures/BFplot_phi035.tex',width=430/72.27,height=250/72.27)
par(mar=c(6.1, 6.1, 2.1, 2.1),mgp=c(5, 1, 0))
plot(c(0.0,0.2,0.5,0.8),logtablefig_phi0.35[1,3:6],type="b",pch=4,lty=1,lwd=2,bty="l",ylab="BF12",xlab="deltaDelta",xaxt="n",ylim=c(log10(0.01),log10(70)),yaxt="n")
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.35[2,3:6],type="b",pch=4,lty=2,lwd=2)
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.35[3,3:6],type="b",pch=1,lty=1,lwd=2)
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.35[4,3:6],type="b",pch=1,lty=2,lwd=2)
legend(x=0.5,y=log10(70),legend=c("nrepl=40","nrepl=100"),lty=c(1,2),box.lty=0)
legend(x=0.7,y=log10(70),legend=c("norig=40","norig=100"),pch=c(4,1),box.lty=0)
axis(1, at=seq(0,0.8,0.1))
axis(2, at=c(log10(0.01),log10(1/3),log10(1),log10(3),log10(10)),labels=c("log0.01","log1/3","log1","log3","log10"),las=1)
abline(h=log10(1))
abline(h=log10(1/3),lty=2)
abline(h=log10(3),lty=2)
dev.off()

# create .tex file for Figure 3c
tikz('D:/Dropbox/April2016/April/Data archive April/Figures/BFplot_phi05.tex',width=430/72.27,height=250/72.27)
par(mar=c(6.1, 6.1, 2.1, 2.1),mgp=c(5, 1, 0))
plot(c(0.0,0.2,0.5,0.8),logtablefig_phi0.5[1,3:6],type="b",pch=4,lty=1,lwd=2,bty="l",ylab="BF12",xlab="deltaDelta",xaxt="n",ylim=c(log10(0.01),log10(70)),yaxt="n")
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.5[2,3:6],type="b",pch=4,lty=2,lwd=2)
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.5[3,3:6],type="b",pch=1,lty=1,lwd=2)
points(c(0.0,0.2,0.5,0.8),logtablefig_phi0.5[4,3:6],type="b",pch=1,lty=2,lwd=2)
legend(x=0.5,y=log10(70),legend=c("nrepl=40","nrepl=100"),lty=c(1,2),box.lty=0)
legend(x=0.7,y=log10(70),legend=c("norig=40","norig=100"),pch=c(4,1),box.lty=0)
axis(1, at=seq(0,0.8,0.1))
axis(2, at=c(log10(0.01),log10(1/3),log10(1),log10(3),log10(10)),labels=c("log0.01","log1/3","log1","log3","log10"),las=1)
abline(h=log10(1),lty=4)
abline(h=log10(1/3),lty=3)
abline(h=log10(3),lty=3)
dev.off()

par(mar=c(5.1, 4.1, 4.1, 2.1),mgp=c(3, 1, 0))
